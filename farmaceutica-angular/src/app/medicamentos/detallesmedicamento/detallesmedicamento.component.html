<div class="container py-4">

  <!-- Mostrar error, si lo hay -->
  @if (error()) {
    <div class="alert alert-danger">{{ error() }}</div>
  }

  <h1 class="display-4 mb-4">{{ medicamento()?.nombre }}</h1>

  <div class="row mb-4">
    <div class="col-md-12">
      <div class="card shadow-sm">
        <div class="card-body">
          <h5 class="card-title">Descripción</h5>
          <p class="card-text">{{ medicamento()?.descripcion }}</p>
        </div>
      </div>
    </div>
  </div>

  <div class="row mb-5">
    <div class="col-md-12">
      <div class="card shadow-sm">
        <div class="card-body">
          <h5 class="card-title">Ingredientes:</h5>
          @for (ingrediente of (medicamento()?.ingredientes ?? []); let i = $index; track ingrediente) {
            <span>
              {{ ingrediente }}
              @if (i < (medicamento()?.ingredientes?.length ?? 0) - 1) { , } @else { . } 
            </span>
          }
        </div>
      </div>
    </div>
  </div>

  <!-- Información principal -->
  <div class="row mb-5">
    <div class="col-md-6 mb-3">
      <div class="card h-100 shadow-sm">
        <div class="card-body">
          <h5 class="card-title">Cantidad Disponible</h5>
          @if(medicamento()?.cantidad <= medicamento()?.stock_minimo) { 
            <p class="card-text fs-4 text-danger fw-bold">{{medicamento()?.cantidad }}</p>
          } @else {
            <p class="card-text fs-4">{{ medicamento()?.cantidad }}</p>
          }
        </div>
      </div>
    </div>
    <div class="col-md-6 mb-3">
      <div class="card h-100 shadow-sm">
        <div class="card-body">
          <h5 class="card-title">Tipo</h5>
          <p class="card-text fs-5">{{ medicamento()?.tipo }}</p>
        </div>
      </div>
    </div>
    <div class="col-md-6 mb-3">
      <div class="card h-100 shadow-sm">
        <div class="card-body">
          <h5 class="card-title">Ubicación</h5>
          <p class="card-text fs-5">{{ medicamento()?.ubicacion }}</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Gráficos: Pedidos y Ventas -->
  <div class="row mb-5">
    <!-- Imagen Pedidos -->
    @if (medicamento()?.pedidos?.length > 0) {
      <div class="col-md-6 mb-3">
        <div class="card shadow-sm h-100">
          <div class="card-body d-flex flex-column">
            <h5 class="card-title">Pedidos</h5>
            <div style="position: relative; height:300px;">
              <img 
                [src]="pedidosChartUrl!" 
                alt="Gráfico de Pedidos" 
                style="max-height: 100%; max-width: 100%; object-fit: contain;" />
            </div>
          </div>
        </div>
      </div>
    }

    <!-- Imagen Ventas -->
    @if (medicamento()?.ventas?.length > 0) {
      <div class="col-md-6 mb-3">
        <div class="card shadow-sm h-100">
          <div class="card-body d-flex flex-column">
            <h5 class="card-title">Ventas</h5>
            <div style="position: relative; height:300px;">
              <img 
                [src]="ventasChartUrl!" 
                alt="Gráfico de Ventas" 
                style="max-height: 100%; max-width: 100%; object-fit: contain;" />
            </div>
          </div>
        </div>
      </div>
    }
  </div>

  <!-- Botón Volver -->
  <div class="d-flex">
    <button class="btn btn-primary me-3" (click)="goBack()">Volver</button>
  </div>

</div>
